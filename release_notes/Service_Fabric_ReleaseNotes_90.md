# Microsoft Azure Service Fabric 9.0 Release Notes

This release includes the bug fixes and features described in this document. This release also includes runtime, SDKs, and Windows Server Standalone deployments to run on-premises.

<br>

## Packages and Versions

The following packages and versions are part of this release:

| Service | Platform | Version |
|-|-|-|
|Service Fabric Runtime| Ubuntu 18.04 <br> Ubuntu 20.04 <br> Windows | 9.0.1018.1 <br> 9.0.1018.1 <br> 9.0.1017.9590 |
|Service Fabric for Windows Server|Service Fabric Standalone Installer Package | 9.0.1017.9590 |
|.NET SDK |Windows .NET SDK <br> Microsoft.ServiceFabric <br> Reliable Services and Reliable Actors <br> ASP.NET Core Service Fabric integration| 6.0.1017 <br> 9.0.1017 <br> 9.0.1017 <br> 9.0.1017 |
|Java SDK |Java for Linux SDK | 1.0.6 |
|Service Fabric PowerShell and CLI | AzureRM PowerShell Module <br> SFCTL | 0.3.15 <br> 11.1.0 |

<br>

## Contents 

Microsoft Azure Service Fabric 9.0 Release Notes

* [Key Announcements](#key-announcements)
* [Service Fabric Runtime](#service-fabric-runtime)
* [Future Retirement and Deprecation Path Callouts](#future-retirement-and-deprecation-path-callouts)
* [Current Breaking Changes](#current-breaking-changes)
* [Service Fabric Add-ons Applications](#service-fabric-add-ons-applications)
* [Repositories and Download Links](#repositories-and-download-links)

<br>

## Key Announcements

* [**General Availability**] Support for .NET 6.0
* [**General Availability**] Support for Ubuntu 20.04
* [**General Availability**] Support for Multi-AZ within a single VM Scale Set (VMSS)
* Added support for IHost, IHostBuilder and Minimal Hosting Model
* Enabling opt-in option for Data Contract Serialization (DCS) based remoting exception
* Support creation of End-to-End Developer Experience for Linux development on Windows using WSL2
* Support for parallel recursive queries to Service Fabric DNS Service
* Support for Managed KeyVaultReference
* Expose Container ID for currently deployed code packages
* Added Fabric_InstanceId environment variable for stateless guest applications
* Exposed API for reporting MoveCost
* Enforce a configurable Max value on the InstanceCloseDelayDuration
* Added ability to enumerate actor reminders
* Made updates to platform events
* Introduced a property in Service Fabric runtime that can be set via SFRP as the ARM resource ID
* Exposed application type provision timestamp
* Support added for Service Fabric Resource Provider (SFRP) metadata to application type + version entities, starting with ARM resource ID
* Updates to Service Fabric Explorer (SFX) with 9.0

Read more about these key announcements in the sections listed below.

<br>

## Service Fabric Runtime

All features and fixes listed in the table below are targeted for the following package versions:<br>

| OS | Service Fabric Runtime Version |
|-|-|
| **Windows** | **9.0.1017.9590** |
| **Ubuntu 18.04** | **9.0.1018.1** |
| **Ubuntu 20.04** | **9.0.1018.1** |

<br>

| S# | IssueType | Description | Resolution | 
|-|-|-|-|
| 1. | **Feature** | [**General Availability**] Support for .NET 6.0 | **Brief Description**: Support for .NET 6.0 has been in preview since Service Fabric runtime v8.2 and Service Fabric SDK v5.2. With Service Fabric runtime v9.0 and Service Fabric SDK v.6.0 release, this has now been made generally available.<br>Please read further feature sections in this table for features that ship with this support, including IHost, IHostBuilder support, Data Contract Serializer support, etc.<br>Support for .NET 6.0 for Service Fabric has been made available in Visual Studio 2022 v7.1 onwards. To enable using this feature in [Visual Studio 2022 version 17.1](https://docs.microsoft.com/en-us/visualstudio/releases/2022/release-notes) or beyond, install the Service Fabric SDK v6.0 or greater.<br>**Impact**: Service Fabric application running on .NET 5.0 can now be upgraded to .NET 6.0.<br>**Documentation Reference**: Read more about it at -<ul><li>[Service Fabric supported versions](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-versions)</li><li>See feature *Added support for IHost, IHostBuilder and Minimal Hosting Model* listed below</li><li>See feature *Enabling opt-in option for Data Contract Serialization (DCS) based remoting exception* listed below</li></ul> |
| 2. | **Feature** | [**General Availability**] Support for Ubuntu 20.04 | **Brief Description**: Service Fabric is available for use on Ubuntu 20.04 LTS based compute.<br>**Impact**:Service Fabric now supports creation of clusters that utilize Ubuntu 20.04 LTS. All current Linux-based features are fully supported. It is encouraged, after thorough validation of your workload, to upgrade clusters to use 20.04 LTS. Existing 16.04 LTS and 18.04 LTS clusters can directly be upgraded to 20.04.<br>**Documentation Reference**: Read more about it at -<ul><li>[Deploy a Linux Service Fabric cluster into an Azure virtual network](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-tutorial-create-vnet-and-linux-cluster)</li><li>[Set up a Container based local cluster](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-get-started-linux?tabs=sdksetupubuntu%2Clocalclusteroneboxcontainer#set-up-a-local-cluster)</li><li>[Upgrading Linux OS for Azure Service Fabric](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-cluster-upgrade-os)</li><li>[Ubuntu 20.04 Service Fabric cluster - Sample Templates](https://github.com/Azure-Samples/service-fabric-cluster-templates/tree/master/7-VM-Ubuntu-2004-3-NodeTypes-Secure)</li><li>Also see feature *Support creation of End-to-End Developer Experience for Linux development on Windows using WSL2* listed below</li></ul> |
| 3. | **Feature** | [**General Availability**] Support for Multi-AZ within a single VM Scale Set (VMSS) | **Brief Description**: AZ Spanning Virtual Machine Scale Sets (VMSS) has been in preview and is now entering general availability.<br>VMSS upgrades can now be configured to occur sequentially 1 zone at a time by setting VMSSZonalUpgradeMode = "Hierarchical". This value can be updated on the VMSS at anytime after creation.<br>**Documentation Reference**: Read more about it at -<ul><li>[Deploy an Azure Service Fabric cluster across Availability Zones](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-cross-availability-zones)</li></ul> |
| 4. | **Feature** | Added support for IHost, IHostBuilder and Minimal Hosting Model | **Brief Description**: IHost integration in KestrelCommunicationListener and HttpSysCommunicationListener was shipped in SDK v5.2.1363 in Preview. In Service Fabric 9.0, this is made generally available.<br>Add IHost and Minimal Hosting based web service samples in the documentation.<br>In addition to IWebHost/IWebHostBuilder, KestrelCommunicationListener and HttpSysCommunicationListener now support building ASP.NET Core web services using IHost/IHostBuilder.<br>.Net 6 introduced the Minimal Hosting model which is a more simplified and streamlined way of creating ASP.NET Core web applications. Minimal hosting model can also be used for creating Service Fabric ASP.NET Core services.<br>This was available in preview starting with v5.2.1363 of Microsoft.ServiceFabric.AspNetCore.Kestrel and Microsoft.ServiceFabric.AspNetCore.HttpSys packages. Starting with Service Fabric v.9.0, this has been made generally available.<br>**Documentation Reference**: Read more about it at -<ul><li>[ASP.NET Core in Azure Service Fabric Reliable Services](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-reliable-services-communication-aspnetcore)</li><li>[IHost and Minimal Hosting integration](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-reliable-services-communication-aspnetcore#ihost-and-minimal-hosting-integration)</li></ul> |
| 5. | **Feature** | Enabling opt-in option for Data Contract Serialization (DCS) based remoting exception | **Brief Description**: BinaryFormatter is the default exception serializer for v2 remoting. AspNetCore 5 blocks BinaryFormatter serialization by default.<br>Starting with Aspnet 5.0, BinaryFormatter based serialization is blocked by default. This change affected exception messaging in remoting services. If the service code is dependent on remoting exception for exception handling, retry logic, etc., then the user would need to use EnableUnsafeBinaryFormatterSerialization in their aspnet project file.<br>**Impact**: This feature introduces an opt-in method to enable DataContract remoting exception serialization.<br>**Solution**: Remoting V2 introduces DataContract remoting exception serialization. Users can opt this feature by using abricTransportRemotingListenerSettings.ExceptionSerializationTechnique on the Service side and FabricTransportRemotingSettings.ExceptionDeserializationTechnique on the client side.<br>**Documentation Reference**: Read more about it at -<ul><li>[Enabling Data Contract serialization for Remoting exceptions in Service Fabric](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-reliable-services-exception-serialization)</li></ul> |
| 6. | **Feature** | Support creation of End-to-End Developer Experience for Linux development on Windows using WSL2 | **Brief Description**: Provide an updated Service Fabric SDK that will support Linux Local Cluster Management in Windows based on Windows Subsystem for Linux 2 (WSL2) based Ubuntu Virtual Machines (VM).<br>**Impact**: This is an additional feature and will not have any impact on existing behavior.<br>**Solution**: This feature provides a functionality to setup and manage Linux Local Cluster Management in Windows based on WSL2 based Ubuntu VMs.<br>**Documentation Reference**: Read more about it at -<ul><li>[Set up Azure Service Fabric Linux cluster on WSL2 linux distribution inside Windows](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-local-linux-cluster-windows-wsl2)</li><li>[Script to setup Service Fabric local cluster for Linux VM using WSL2](https://github.com/microsoft/service-fabric-scripts-and-templates/blob/master/scripts/SetupServiceFabric/SetupServiceFabric.sh)</li></ul> |
| 7. | **Feature** | Support for parallel recursive queries to Service Fabric DNS Service | **Brief Description**: This change adds support for parallel recursive queries in Service Fabric DNS, where requests will be sent to all forwarding DNS servers and the first response received is used. When enabled, parallel queries will be attempted after the serial queries. The following config options are introduced under **DNS Service** to control the behavior:<br><ul><li>**RecursiveQuerySerialMaxAttempts** - The number of serial queries that will be attempted, at most. If this number is higher than the amount of forwarding DNS servers, querying will stop once all the servers have been attempted exactly once.</li><li>**RecursiveQuerySerialTimeout** - The timeout value in seconds for each attempted serial query.</li><li>**RecursiveQueryParallelMaxAttempts** - The number of times parallel queries will be attempted. Parallel queries are executed after the max attempts for serial queries have been exhausted.</li><li>**RecursiveQueryParallelTimeout** - The timeout value in seconds for each attempted parallel query.</li></ul>If clusters were previously using the RecursiveQueryTimeout config option, they will need to remove it before upgrading; this config is replaced by the ones above.<br>**Documentation Reference**: Read more about it at - <ul><li>[DNS Service in Azure Service Fabric - Recursive Queries](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-dnsservice#recursive-queries)</li><li>[What is the default behavior of a DNS client when three or more DNS servers are configured on the NIC](https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/dns-client-resolution-timeouts#what-is-the-default-behavior-of-a-dns-client-when-three-or-more-dns-servers-are-configured-on-the-nic)</li><li>[What is the default behavior of a Windows XP DNS client when two DNS servers are configured on the NIC](https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/dns-client-resolution-timeouts#what-is-the-default-behavior-of-a-windows-xp-dns-client-when-two-dns-servers-are-configured-on-the-nic)</li></ul> |
| 8. | **Feature** | Support for Managed KeyVaultReference | **Brief Description**: Service Fabric's auto-rotation story for application secrets is here: Managed KeyVaultReferences. Leverage Managed Identities for Service Fabric applications and KeyVaultReferences to get automatic application parameter upgrades as your secrets rotate in the vault.<br>**Documentation Reference**: Read more about it at - <ul><li>[Use KeyVaultReferences in your application](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-keyvault-references#use-keyvaultreferences-in-your-application), and </li><li>[Use Managed KeyVaultReferences in your application](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-keyvault-references#use-managed-keyvaultreferences-in-your-application)</li></ul> |
| 9. | **Feature** | Expose Container ID for currently deployed code packages | **Brief Description**: For processes, Process ID is available from CodePackageEntryPoint structure in both Service Fabric Explorer (SFX) and through Get-ServiceFabricDeployedCodePackage in Powershell. However, for containers the Container ID was not previously available. Service Fabric will now expose Container ID in the same fashion that Process ID is exposed.<br>**Solution**: Container ID is added to the CodePakageEntryPoint structure, exposing it in both Service Fabric Explorer (SFX) and through Get-ServiceFabricDeployedCodePackage in Powershell.<br>**Workaround**: Multiple queries to docker/containerD API to get the container ID and decide which is its corresponding code package. |
| 10. | **Feature** | Added Fabric_InstanceId environment variable for stateless guest applications | **Brief Description**: Adding Fabric_InstanceId environment variable for stateless guest applications.<br>**Impact**: In order to report health for guest applications replicas using HTTP-based Fabric client from within the guest application, the following information is required: PartitionId, ReplicaId (for stateful replicas) and InstanceId (for stateless replicas).<br>Today, we already provide PartitionId and ReplicaId (for stateful replicas) as environment variables. Adding the missing InstanceId environment variable for stateless replicas will complete the required information.<br>**Documentation Reference**: To view the list of available Service Fabric environment variable - <ul><li>[Service Fabric environment variables](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-environment-variables-reference)</li></ul> |
| 11. | **Feature** | Exposed API for reporting MoveCost | **Brief Description**: Exposed API for reporting MoveCost on behalf of other service replicas and partitions.<br>**Impact**: MoveCost could be changed with action outside of partition. If clients don't own service logic, they could use only static load.<br>**Solution**: New API allows reporting MoveCost from outside of the service, which could be beneficial for clients that don't have service logic.<br>**Documentation Reference**: Read more about it at - <ul><li>[Reporting move cost for a partition](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-cluster-resource-manager-movement-cost#reporting-move-cost-for-a-partition)</li></ul>**Workaround**: Replicas could report MoveCost values for themselves or clients could specify static MoveCost value during service creation. |
| 12. | **Feature** | Enforce a configurable Max value on the InstanceCloseDelayDuration | **Brief Description**: Enforcing a configurable Max value on the InstanceCloseDelayDuration to prevent users from inadvertently specifying huge delay values which could result in updates getting stuck.<br>Checks have been added in service creation/updation, app upgrade, application and fabric upgrade overrides to prevent users from configuring anything more than the max config value.<br>The max value is a cluster configuration, defaulting to 30mins, so an InstanceCloseDelay can't be specified more than this value. Users can modify this value to anything they require in the cluster config.<br>For already misconfigured services, the delay would be ceiled to the max config value.<br>**Documentation Reference**: For more about it at <ul><li>[Service Fabric application upgrade: Advanced topics](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-application-upgrade-advanced)</li></ul>**Breaking Change**: This would be a **breaking change** if customers are already configuring more than 30 mins delay.<br>**Workaround**: They would need to define a higher value in the cluster config. |
| 13. | **Feature** | Added ability to enumerate actor reminders | **Brief Description**: Exposed an API to list all the reminders in the actor service.GetReminderAsync() API has been added to IActorService to enable users to enumerate reminders. <br>**Solution**: Actor customers now have the ability to enumerate the reminders in their service. If a null value is passed to the actorId filter, then the API returns list of all the reminders. If a valid actor ID is passed, then all the reminders corresponding to the actor ID input are returned.<table><tr><td><pre lang="csharp">Task<ReminderPagedResult<KeyValuePair<ActorId, List<ActorReminderState>>>> GetRemindersAsync(<br>    ActorId actorId,<br>    ContinuationToken continuationToken,<br>    CancellationToken cancellationToken);</pre></td></tr><tr><td></table>The page size of the result can be controlled by setting the PageSize static field of the ReminderPagedResult inside the actor service.<table><tr><td><pre lang="csharp">ReminderPagedResult<KeyValuePair<ActorId, List<ActorReminderState>>>.SetDefaultPageSize(/*new size*/)</pre></td></tr></table>**Documentation Reference**: Read more about it at -<ul><li>IActorService.GetReminderAsync</li></ul> |
| 14. | **Feature** | Made updates to platform events | **Brief Description**: This update adds new page under each Infrastructure Service section which displays information related to undergoing Infrastructure updates on the Virtual Machine Scale Sets. Users can get information about currently Executing updates, Pending updates and the State of each update right from the Service Fabric Explorer (SFX).<br>**Impact**: This helps in quickly identifying the undergoing infrastructure updates and understanding overall health of the Cluster.<br>Correlating Infrastructure updates with corresponding repair Tasks, to identify why the updates are stuck.<br>**Documentation Reference**: Read more about it at -<ul><li>[Introduction to the Service Fabric Infrastructure Service](https://docs.microsoft.com/en-us/azure/service-fabric/infrastructure-service-faq)</li><li>[Azure Service Fabric node types and virtual machine scale sets](https://docs.microsoft.com/en-us/azure/service-fabric/service-fabric-cluster-nodetypes)</li></ul> |
| 15. | **Feature** | Support added for Service Fabric Resource Provider (SFRP) metadata to application type + version entities, starting with ARM resource ID | **Brief Description**: Added a new API that can be used to add SFRP metadata to application type entities.<br>**Impact**: To better support Service Fabric Resource Provider (SFRP) and Service Fabric managed clusters (SFMC) scenarios, Service Fabric runtime needs to allow support for additional metadata for ARM deployed resources.<br>The ability to add or modify the metadata in only support for Service Fabric Resource Provider (SFRP) and Service Fabric managed clusters (SFMC). The ability to query the metadata is available to all.<br>**Documentation**: Read more about it at -<ul><li>[Get Application Type Info List](https://docs.microsoft.com/en-us/rest/api/servicefabric/sfclient-api-getapplicationtypeinfolist)</li><li>[Get Application Type Info List By Name](https://docs.microsoft.com/en-us/rest/api/servicefabric/sfclient-api-getapplicationtypeinfolistbyname)</li><li>[Application Type Info](https://docs.microsoft.com/en-us/rest/api/servicefabric/sfclient-model-applicationtypeinfo)</li><li>Application Type Update Description</li><li>[Provision Application Type](https://docs.microsoft.com/en-us/rest/api/servicefabric/sfclient-api-provisionapplicationtype)</li><li>[Provision Application Type Description Base](https://docs.microsoft.com/en-us/rest/api/servicefabric/sfclient-model-provisionapplicationtypedescriptionbase)</li></ul> |
| 16. | **Feature** | Introduced a property in Service Fabric runtime that can be set via SFRP as the ARM resource ID | **Brief Description**: To better support Service Fabric Resource Provider (SFRP) and Service Fabric managed clusters (SFMC) scenarios, Service Fabric runtime needs to allow support for additional metadata for ARM deployed resources.<br>**Impact**: Metadata added for application type are application type provision timestamp and arm resource ID. Metadata added for application, service, and cluster are ARM resource ID.<br>Existing API's have been updated to read this metadata and support for Powershell, REST, and FabricClient have been added.<br>The runtime created a new API for Service Fabric Resource Provider (SFRP) for updating the metadata. Currently, no public support is provided for Powershell since this is only available only for Service Fabric Resource Provider (SFRP) and Service Fabric managed clusters (SFMC) use<br>**Documentation Reference**: Read more about it at - <ul><li>ApplicationTypeMetadata</li><li>ApplicationMetadata</li><li>ServiceMetadata</li></ul> |
| 17. | **Feature** | Exposed application type provision timestamp | **Brief Description**: Added application type provision timestamp that is exposed via existing application type API's.<br>**Impact**: To better support Service Fabric Resource Provider (SFRP) and Service Fabric managed clusters (SFMC) scenarios, Service Fabric runtime needs to allow support for additional metadata for ARM deployed resources.<br>**Documentation Reference**: Read more about it at - <ul><li>ApplicationTypeMetadata</li></ul> |
| 18. | **Bug Fix** | Managed Identity Token Service (MITS) fails renegotiation with gateway on systems with TLS 1.3 enabled | **Brief Description**: MITS will lose its connection to the gateway when deployed on Win2022 and won't attempt to renegotiate it.<br>**Impact**: On Windows 2022 or other situations where TLS1.3 is available/the default, MITS will fail to renegotiate its inbound connections and will fail all inbound requests. SF-hosted user services attempting to acquire tokens representing their managed identities will experience timeouts.<br>**Fix**: Limit MITS to using TLS 1.2 only, until Windows 2022 becomes a supported OS for Service Fabric.<br>**Workaround**: Note Service Fabric does not list Windows 2022 as a supported OS version at this time - primarily because it defaults to TLS1.3, and the SF runtime needs additional fixes to support this scenario. Our recommendation is to stick with the officially supported OS images/versions. In this particular case, restarting MITS on the failing node will work momentarily, which may be sufficient for an application to obtain its tokens. However, the failing behavior will reoccur within the order of minutes. |
| 19. | **Bug Fix** | Validation fails when RunToCompletion is specified and ServicePackageActivationMode is SharedProcess | **Brief Description**: New services, including both default services for new applications and new services for existing applications, will fail validation when they are set to RunToCompletion and ServicePackageActivationMode is SharedProcess. Such cases have never been supported by Service Fabric; however, we would accept these services and not honor RunToCompletion, so they would restart on exit.<br>**Impact**: Before, we would accept services set to RunToCompletion where ServicePackageActivationMode was SharedProcess, yet we did not honor RunToCompletion. Now validation will fail in that scenario and all services set to RunToCompletion will honor that execution policy.<br>**Fix**: For default services, validation fails during ApplicationManifest validation. For new services on existing applications, the cluster manager (CM) fails the new service validation before creating it.<br>**Documentation Reference**: Read more about it at -<ul><li>[RunToCompletion](https://docs.microsoft.com/en-us/azure/service-fabric/run-to-completion)</li></ul>**Breaking Change**: New applications and application upgrades where there are default services that RunToCompletion and ServicePackageActivationMode is SharedProcess will fail. New services for existing applications will also fail for such cases. |
| 20. | **Bug Fix** | IActorService.GetActors fails in KVS due to case sensitivity | **Brief Description**: GetActors API returns a single page infinitely if a KVS actor service has upper case actors as well as lower case actors.<br>**Impact**: GetActors enumeration API<br>**Fix**: GetActors API will enumerate all actors in the KVS service with upper and lower case actors |
| 21. | **Tool Update** | Updates to Service Fabric Explorer (SFX) with 9.0 | **Brief Description**: Find more details, about updates to SFX with the 9.0 release, at -<ul></li>[Service Fabric Explorer 9.0 Release notes](https://github.com/microsoft/service-fabric-explorer/issues/712)</li></ul> |

<br>

## Future Retirement and Deprecation Path Callouts

| Support | Option | Details |
|-|-|-|
| **Retired support for ASP.NET Core 1.0** | Migrate usage to ASP.NET Core 2.1 or greater | Service Fabric ASP.NET Core packages are built against ASP.NET Core 1.0 binaries, which are out of support. Starting Service Fabric 8.2, we will be building Service Fabric ASP.NET Core packages against .NET Core 3.1, .NET Core 5.0, .NET Core 6.0, .NET Framework 4.6.1. As a result, they can be used only to build services targeting .NET Core 3.1, .NET Core 5.0, .NET Core 6.0, >=.NET Framework 4.6.1 respectively.<br>For .NET Core 3.1, .NET Core 5.0, .NET Core 6.0, Service Fabric ASP.NET Core will be taking dependency on Microsoft.AspNetCore.App shared framework; whereas, for NetFx target frameworks >=.NET Framework 4.6.1, Service Fabric ASP.NET Core will be taking dependency on ASP.NET Core 2.1 packages.<br>The package Microsoft.ServiceFabric.AspNetCore.WebListener will no longer be shipped, Microsoft.ServiceFabric.AspNetCore.HttpSys package should be used instead.|
| **Deprecated support for .NET Core 2.x** | Migrate usage to .NET Core 3.1 | .NET Core runtime LTS 2.1 runtime is out of support as of Aug 21, 2021, and .NET Core runtime 2.2 is out of support since Dec 2019.<br>Service Fabric releases after those dates will drop support for Service Fabric applications running with .NET Core 2.1 and .NET Core 2.2 runtimes respectively.<br>Current applications running on .NET Core 2.x runtime will continue to work as-is, but requests for investigations or request for changes will no longer be entertained. Please migrate to using .NET Core 3.1 instead at the earliest as support for .NET Core 2.1 will be retired soon.<br>Service Fabric .NET SDK will take a dependency on .NET runtime 3.x features to support Service Fabric .NET Core applications. |
| **(Upcoming) Deprecation of support for .NET 5.0** | Migrate usage to .NET 6.0 or .NET Core 3.1 |.NET 5.0 runtime is reaching end-of-life on May 8, 2022.<br>Service Fabric releases after that date will drop support for Service Fabric applications running with .NET 5.0 runtime.<br>Current applications running on .NET 5.0 runtime will continue to work, but requests for investigations or request for changes will no longer be entertained. Please migrate to using .NET 6.0 version instead at the earliest as support for .NET 5.0 will be retired soon. |
| **(Upcoming) Retirement of support for Ubuntu 16.04** | Upgrade to more recent 18.04 LTS or 20.04 LTTS | Ubuntu 16.04 LTS reached its 5-year end-of-life window on April 30, 2021.<br>Service Fabric runtime has dropped support for 16.04 LTS, and we recommend moving your clusters and applications to Ubuntu 18.04 LTS or 20.04 LTS.<br>Current applications running on it will continue to work, but requests for investigations or requests for change will no longer be entertained. Please migrate to Ubuntu 18.04 or 20.04 instead at the earliest as support for Ubuntu 16.04 will be retired soon.<br>Service Fabric runtime will soon be permenantly retiring support for Ubuntu 16.04 LTS and will no longer make packages available for it. |
| **(Upcoming) Deprecation of support for BinaryFormatter based remoting exception serialization** | Migrate usage to Data Contract Serilization (DCS) based remoting exception. | .NET team strongly recommends against using BinaryFormatter class due to security vulnerabilities and has marked its serialization and deserielization methods as obsolete.<br>Current applications using it will continue to work as-is, but Service Fabric strongly recommends moving to using Data Contract Serilization (DCS) based remoting exception instead.<br>Service Fabric runtime will soon be stop using BinaryFormatter based remoting exception serialization by default and move to using Data Contract Serilization (DCS) based remoting exception serialization by default. |
| **(Upcoming) Archival and removal of older version of Service Fabric packages from the Download Center** | Migrate to more recent and supported versions of Service Fabric runtime | Service Fabric runtime will soon be archiving and removing Service Fabric runtime version 6.4 packages and older, as well as SDK version 3.3 packages and older from the package Down Center. |

<br>

## Current Breaking Changes

* **Guest Executable and Container Applications**: Guest executable and container applications created or upgraded in Service Fabric clusters with runtime versions 7.1+ are incompatible with prior Service Fabric runtime versions (e.g. Service Fabric 7.0).<br/>
    Following scenarios are impacted:<br/>
    * An application with guest executables or containers is created or upgraded in a Service Fabric 7.1+ cluster.<br/>
    The cluster is then downgraded to a previous Service Fabric runtime version (e.g. Service Fabric 7.0).<br/>
    The application fails to activate.<br/>
    * A cluster upgrade from a version prior to Service Fabric v7.1 to Service Fabric 7.1+ version is in progress.<br/>
    In parallel with the Service Fabric runtime upgrade, an application with guest executables or containers is created or upgraded.<br/>
    The Service Fabric runtime upgrade starts rolling back (due to any reason) to a version prior to Service Fabric runtime v7.1.<br/>
    The application fails to activate.<br/>
    To avoid issues when upgrading from a version prior to Service Fabric runtime v7.1 to a Service Fabric 7.1+ runtime version, do not create or upgrade applications with guest executables or containers while the Service Fabric runtime upgrade is in progress.<br/>
    * The simplest mitigation, when possible, is to delete and recreate the application in Service Fabric 7.0.<br/>
    * The other option is to upgrade the application in Service Fabric 7.0 (for example, with a version only change).<br/>
    If the application is stuck in rollback, the rollback has to be first completed before the application can be upgraded again.

<br>

## Service Fabric Add-ons Applications

**FabricHealer - Auto-Mitigation in Service Fabric Clusters**

[FabricHealer](https://github.com/microsoft/service-fabric-healer) is a Service Fabric application that attempts to automatically fix a set of reliably solvable problems that can take place in Service Fabric application services, including containers, host virtual machines, and logical disks (scoped to space usage problems only). These repairs mostly employ a set of Service Fabric API calls, but can also be fully customizable (like Disk repair). All repairs are safely orchestrated through Service Fabric’s RepairManager service. Repair configuration is written as Prolog-like logic with [supporting external predicates](https://github.com/microsoft/service-fabric-healer/tree/main/FabricHealer/Repair/Guan) written in C#. This is made possible by a new logic programming library for .NET, [Guan](https://github.com/microsoft/guan). The fun starts when FabricHealer detects supported error or warning states reported by [FabricObserver](https://github.com/microsoft/service-fabric-observer). FabricHealer requires FabricObserver to be running in the same cluster.

We are especially interested in feedback with respect to the new [Configuration-as-Logic](https://github.com/microsoft/service-fabric-healer/blob/main/Documentation/LogicWorkflows.md) feature. Out of the box, FabricHealer is configured to solve several problems automatically. You do not have to be a logic programmer to use FabricHealer right away. Check out the [scenario-based getting started samples](https://github.com/microsoft/service-fabric-healer/blob/main/Documentation/Using.md) to get going quickly. There are several logic rules supplied by default that span service to VM level auto-mitigation. You just need to change arguments in the rules to match your needs. 

We are also very interested in your feedback with respect to Guan, should you want to dig into its design and implementation and/or use it in other .NET projects. The way FabricHealer employs Guan is just one use case. As a general purpose logic programming library (.NET Standard), Guan can be used to solve any number of logic programming problems for .NET developers.

Please experiment with FabricHealer Preview in your Test clusters and let us know how it goes. Please create issues on the [FabricHealer](https://github.com/microsoft/service-fabric-healer) repo. Thank you!

<br>

## Repositories and Download Links
The table below is an overview of the direct links to the packages associated with this release. 
Follow this guidance for setting up your developer environment: 
* [Geting Started with Linux](https://docs.microsoft.com/azure/service-fabric/service-fabric-get-started-linux)
* [Getting Started with Mac](https://docs.microsoft.com/azure/service-fabric/service-fabric-get-started-mac)
* [Getting Started with Windows](https://docs.microsoft.com/azure/service-fabric/service-fabric-get-started)

| Area | Package | Version | Repository | Direct Download Link |
|-|-|-|-|-|
|Service Fabric Runtime |Ubuntu Developer Set-up | 9.0.1018.1 |N/A | Cluster Runtime: https://apt-mo.trafficmanager.net/repos/servicefabric/pool/main/s/servicefabric <br> Service Fabric SDK for local cluster setup: https://apt-mo.trafficmanager.net/repos/servicefabric/pool/main/s/servicefabricsdkcommon/ <br> Container image: https://hub.docker.com/r/microsoft/service-fabric-onebox/ 
|| Windows Developer Set-up| 9.0.1017.9590 | N/A | https://download.microsoft.com/download/b/8/a/b8a2fb98-0ec1-41e5-be98-9d8b5abf7856/MicrosoftServiceFabric.9.0.1017.9590.exe |
|Service Fabric for Windows Server |Service Fabric Standalone Installer Package | 9.0.1017.9590 |N/A | https://download.microsoft.com/download/8/3/6/836E3E99-A300-4714-8278-96BC3E8B5528/9.0.1017.9590/Microsoft.Azure.ServiceFabric.WindowsServer.9.0.1017.9590.zip |
||Service Fabric Standalone Runtime | 9.0.1017.9590 |N/A | https://download.microsoft.com/download/B/0/B/B0BCCAC5-65AA-4BE3-AB13-D5FF5890F4B5/9.0.1017.9590/MicrosoftAzureServiceFabric.9.0.1017.9590.cab |
|.NET SDK |Windows .NET SDK | 6.0.1017 |N/A | https://download.microsoft.com/download/b/8/a/b8a2fb98-0ec1-41e5-be98-9d8b5abf7856/MicrosoftServiceFabricSDK.6.0.1017.msi |
||Microsoft.ServiceFabric | 9.0.1017 |N/A |https://www.nuget.org |
||Reliable Services and Reliable Actors<br>\-Microsoft.ServiceFabric.Services<br>\-Microsoft.ServiceFabric.Services.Remoting<br>\-Microsoft.ServiceFabric.Services.Wcf <br>\-Microsoft.ServiceFabric.Actors <br>\-Microsoft.ServiceFabric.Actors.Wcf | 9.0.1017 |https://github.com/Azure/service-fabric-services-and-actors-dotnet |https://www.nuget.org |
||ASP.NET Core Service Fabric integration<br>\-Microsoft.ServiceFabric.Services.ASP.NET Core.*| 9.0.1017 |https://github.com/Azure/service-fabric-aspnetcore |https://www.nuget.org |
||Data, Diagnostics and Fabric transport<br>\-Microsoft.ServiceFabric.Data <br>\-Microsoft.ServiceFabric.Data.Interfaces <br>\-Microsoft.ServiceFabric.Diagnostics.Internal <br>\-Microsoft.ServiceFabric.FabricTransport/Internal | 9.0.1017 |N/A| https://www.nuget.org |
||Microsoft.ServiceFabric.Data.Extensions | 9.0.1017 | N/A |https://www.nuget.org |
|Java SDK |Java SDK | 1.0.6 |N/A |https://mvnrepository.com/artifact/com.microsoft.servicefabric/sf-actors/1.0.6 |
|Eclipse |Service Fabric plug-in for Eclipse | 2.0.7 | N/A |N/A |
|Yeoman |Azure Service Fabric Java generator | 1.0.7 |https://github.com/Azure/generator-azuresfjava |N/A |
||Azure Service Fabric C# generator | 1.0.9 |https://github.com/Azure/generator-azuresfcsharp |N/A |
||Azure Service Fabric guest executables generator | 1.0.1 |https://github.com/Azure/generator-azuresfguest |N/A|
||Azure Service Fabric Container generators | 1.0.1 |https://github.com/Azure/generator-azuresfcontainer |N/A |
|CLI |Service Fabric CLI | 11.1.0 |https://github.com/Azure/service-fabric-cli |https://pypi.python.org/pypi/sfctl |
|PowerShell |AzureRM.ServiceFabric | 0.3.15 |https://github.com/Azure/azure-powershell/tree/preview/src/ResourceManager/ServiceFabric |https://www.powershellgallery.com/packages/AzureRM.ServiceFabric/0.3.15 |
